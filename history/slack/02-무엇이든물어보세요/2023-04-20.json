[
    {
        "client_msg_id": "e7ef2871-e0ee-4e40-86be-f480159287ba",
        "type": "message",
        "text": "안녕하세요, 궁금한 게 생겼는데 여기 계신 분들이 혹시 아실까하여 여쭤봅니다.\nLSQ(Learned step-size quantization) 이라는 quantization method가 있는데, 여기서는 step-size를 또 하나의 learnable parameter로 update를 합니다.\n그런데 궁금한 점이 conv2dLSQ(nn.conv2d 대신 구현한 quantized convolution)를 할 때, quantized 된 weight(int)에 float 타입의 step-size를 곱해진 값을 conv2dLSQ의 weight으로 집어넣게 되거든요.\n이렇게 되면 결국 convolution 할 때 integer만 사용한 것이 아니게 되는 것 같은데, 이런 quantization이 의미가 있는지 궁금하여 여쭤봅니다.\n감사합니다.",
        "user": "U053Y5G924T",
        "ts": "1682038867.781049",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "TJo6",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "안녕하세요, 궁금한 게 생겼는데 여기 계신 분들이 혹시 아실까하여 여쭤봅니다.\nLSQ(Learned step-size quantization) 이라는 quantization method가 있는데, 여기서는 step-size를 또 하나의 learnable parameter로 update를 합니다.\n그런데 궁금한 점이 conv2dLSQ(nn.conv2d 대신 구현한 quantized convolution)를 할 때, quantized 된 weight(int)에 float 타입의 step-size를 곱해진 값을 conv2dLSQ의 weight으로 집어넣게 되거든요.\n이렇게 되면 결국 convolution 할 때 integer만 사용한 것이 아니게 되는 것 같은데, 이런 quantization이 의미가 있는지 궁금하여 여쭤봅니다.\n감사합니다."
                            }
                        ]
                    }
                ]
            }
        ],
        "team": "T04MCQMEXQ9",
        "user_team": "T04MCQMEXQ9",
        "source_team": "T04MCQMEXQ9",
        "user_profile": {
            "avatar_hash": "5fc60de0af34",
            "image_72": "https:\/\/avatars.slack-edge.com\/2023-04-19\/5131369697333_5fc60de0af343a4374f8_72.png",
            "first_name": "정원기",
            "real_name": "정원기 \/ 서울대학교",
            "display_name": "정원기 \/ 서울대학교",
            "team": "T04MCQMEXQ9",
            "name": "wg7139",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "edited": {
            "user": "U053Y5G924T",
            "ts": "1682038945.000000"
        },
        "thread_ts": "1682038867.781049",
        "reply_count": 3,
        "reply_users_count": 3,
        "latest_reply": "1682049026.986879",
        "reply_users": [
            "U04M2NY6U2Y",
            "U04LXKFJLFP",
            "U053Y5G924T"
        ],
        "replies": [
            {
                "user": "U04M2NY6U2Y",
                "ts": "1682043329.173649"
            },
            {
                "user": "U04LXKFJLFP",
                "ts": "1682043757.489739"
            },
            {
                "user": "U053Y5G924T",
                "ts": "1682049026.986879"
            }
        ],
        "is_locked": false,
        "subscribed": false
    },
    {
        "client_msg_id": "FA367441-E595-4945-88D3-14917522015A",
        "type": "message",
        "text": "Quantization 이 적용된 연산을 \"Simulation\" 한다는 의미가 있지 않을까요? 말씀해주신 것 처럼 float 타입 step size 를 곱하면(dequantize 단계를 수행하는 것을 말씀하신 것으로 이해했습니다) weight 가 더이상 int 형이 되지는 않지만, 보통 pytorch 에서 LSQ 와 같은 Quantization method 를 이런식으로 적용하는 목적은 모델의 forward 연산을 quantized weight 가 포함된 연산으로 바꿔주기 위함입니다. (그렇게 되면 quantization 적용된 모델의 성능을 확인할 수 있거나, quantization 의 영향을 확인해볼 수 있겠죠)\n\nRough 하게 2-bit Quantization 예시로 말씀드리자면\n• A: original weight : [1.2, 0.3, -1.2]\n• B: quantized INT weight : [1, 0, -1]\n• C: scale value (~step size) : float 1.2\n• D : dequantized INT weight : [1.2, 0, -1.2]\n보통 Quantization 의 실제 이득을 보려면 B 상태의 weight 를 실제 Matrix Multiplication 연산에 사용해야 메모리 saving 혹은 연산기 측면에서 효율화를 누릴 수 있습니다. 따라서 B 상태에서 Matrix Multiplication 을 해주고, output 값에 step size 와 같은 float 형 scale 값을 곱해주는 것이 일반적인 것으로 알고 있습니다. \n\n하지만 Pytorch Level 에서 저희가 연산을 한다고 할 때 B 상태에서 weight 를 사용하기에는 실제 INT type의 연산을 구현해야한다는 필요가 있기 때문에, D 상태의 weight 를 forward 연산에서 사용하게 됩니다. (1) B 상태로 MATMUL -&gt; Output 에 C 곱하기,  2) weight 를 처음부터 D 상태로 MATMUL 을 하는 것, 1, 2는 연산적으로 Equivalent 함)\n\n추가로 궁금한 점이 있으시거나 제가 잘못말한부분이 있다면 말씀해주시면 감사드리겠습니다 :)",
        "user": "U04M2NY6U2Y",
        "ts": "1682043329.173649",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "q7H",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "Q"
                            },
                            {
                                "type": "text",
                                "text": "uantization "
                            },
                            {
                                "type": "text",
                                "text": "이"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "적용된"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "연산을"
                            },
                            {
                                "type": "text",
                                "text": " \"Simulation\" "
                            },
                            {
                                "type": "text",
                                "text": "한다는"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "의미가"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "있지"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "않을까요"
                            },
                            {
                                "type": "text",
                                "text": "? "
                            },
                            {
                                "type": "text",
                                "text": "말씀해주신"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "것"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "처럼"
                            },
                            {
                                "type": "text",
                                "text": " float "
                            },
                            {
                                "type": "text",
                                "text": "타입"
                            },
                            {
                                "type": "text",
                                "text": " step size "
                            },
                            {
                                "type": "text",
                                "text": "를"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "곱하면"
                            },
                            {
                                "type": "text",
                                "text": "(dequantize "
                            },
                            {
                                "type": "text",
                                "text": "단계를"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "수행하는"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "것을"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "말씀하신"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "것으로"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "이해했습니다"
                            },
                            {
                                "type": "text",
                                "text": ") weight "
                            },
                            {
                                "type": "text",
                                "text": "가"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "더이상"
                            },
                            {
                                "type": "text",
                                "text": " int "
                            },
                            {
                                "type": "text",
                                "text": "형이"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "되지는"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "않지만"
                            },
                            {
                                "type": "text",
                                "text": ", "
                            },
                            {
                                "type": "text",
                                "text": "보통"
                            },
                            {
                                "type": "text",
                                "text": " pytorch "
                            },
                            {
                                "type": "text",
                                "text": "에서"
                            },
                            {
                                "type": "text",
                                "text": " LSQ "
                            },
                            {
                                "type": "text",
                                "text": "와"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "같은"
                            },
                            {
                                "type": "text",
                                "text": " Quantization method "
                            },
                            {
                                "type": "text",
                                "text": "를"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "이런식으로"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "적용하는"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "목적은"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "모델의"
                            },
                            {
                                "type": "text",
                                "text": " forward "
                            },
                            {
                                "type": "text",
                                "text": "연산을"
                            },
                            {
                                "type": "text",
                                "text": " quantized weight "
                            },
                            {
                                "type": "text",
                                "text": "가"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "포함된"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "연산으로"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "바꿔주기"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "위함입니다"
                            },
                            {
                                "type": "text",
                                "text": ". ("
                            },
                            {
                                "type": "text",
                                "text": "그렇게"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "되면"
                            },
                            {
                                "type": "text",
                                "text": " quantization "
                            },
                            {
                                "type": "text",
                                "text": "적용된"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "모델의"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "성능을"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "확인할"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "수"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "있거나"
                            },
                            {
                                "type": "text",
                                "text": ", quantization "
                            },
                            {
                                "type": "text",
                                "text": "의"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "영향을"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "확인해볼"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "수"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "있겠죠"
                            },
                            {
                                "type": "text",
                                "text": ")\n\nRough "
                            },
                            {
                                "type": "text",
                                "text": "하게"
                            },
                            {
                                "type": "text",
                                "text": " 2-bit Quantization "
                            },
                            {
                                "type": "text",
                                "text": "예시로"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "말씀드리자면"
                            },
                            {
                                "type": "text",
                                "text": "\n"
                            }
                        ]
                    },
                    {
                        "type": "rich_text_list",
                        "elements": [
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "A: original weight : [1.2, 0.3, -1.2]"
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "B: quantized INT weight : [1, 0, -1]"
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "C: scale value (~step size) : float 1.2"
                                    }
                                ]
                            },
                            {
                                "type": "rich_text_section",
                                "elements": [
                                    {
                                        "type": "text",
                                        "text": "D : dequantized INT weight : [1.2, 0, -1.2]"
                                    }
                                ]
                            }
                        ],
                        "style": "bullet",
                        "indent": 0,
                        "offset": 0,
                        "border": 0
                    },
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "\n"
                            },
                            {
                                "type": "text",
                                "text": "보통"
                            },
                            {
                                "type": "text",
                                "text": " Quantization "
                            },
                            {
                                "type": "text",
                                "text": "의"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "실제"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "이득을"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "보려면"
                            },
                            {
                                "type": "text",
                                "text": " B "
                            },
                            {
                                "type": "text",
                                "text": "상태의"
                            },
                            {
                                "type": "text",
                                "text": " weight "
                            },
                            {
                                "type": "text",
                                "text": "를"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "실제"
                            },
                            {
                                "type": "text",
                                "text": " Matrix Multiplication "
                            },
                            {
                                "type": "text",
                                "text": "연산에"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "사용해야"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "메모리"
                            },
                            {
                                "type": "text",
                                "text": " saving "
                            },
                            {
                                "type": "text",
                                "text": "혹은"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "연산기"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "측면에서"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "효율화를"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "누릴"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "수"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "있습니다"
                            },
                            {
                                "type": "text",
                                "text": ". "
                            },
                            {
                                "type": "text",
                                "text": "따라서"
                            },
                            {
                                "type": "text",
                                "text": " B "
                            },
                            {
                                "type": "text",
                                "text": "상태에서"
                            },
                            {
                                "type": "text",
                                "text": " Matrix Multiplication "
                            },
                            {
                                "type": "text",
                                "text": "을"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "해주고"
                            },
                            {
                                "type": "text",
                                "text": ", output "
                            },
                            {
                                "type": "text",
                                "text": "값에"
                            },
                            {
                                "type": "text",
                                "text": " step size "
                            },
                            {
                                "type": "text",
                                "text": "와"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "같은"
                            },
                            {
                                "type": "text",
                                "text": " float "
                            },
                            {
                                "type": "text",
                                "text": "형"
                            },
                            {
                                "type": "text",
                                "text": " scale "
                            },
                            {
                                "type": "text",
                                "text": "값을"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "곱해주는"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "것이"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "일반적인"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "것으로"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "알고"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "있습니다"
                            },
                            {
                                "type": "text",
                                "text": ". \n\n"
                            },
                            {
                                "type": "text",
                                "text": "하지만"
                            },
                            {
                                "type": "text",
                                "text": " Pytorch Level "
                            },
                            {
                                "type": "text",
                                "text": "에서"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "저희가"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "연산을"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "한다고"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "할"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "때"
                            },
                            {
                                "type": "text",
                                "text": " B "
                            },
                            {
                                "type": "text",
                                "text": "상태에서"
                            },
                            {
                                "type": "text",
                                "text": " weight "
                            },
                            {
                                "type": "text",
                                "text": "를"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "사용하기에는"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "실제"
                            },
                            {
                                "type": "text",
                                "text": " INT type"
                            },
                            {
                                "type": "text",
                                "text": "의"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "연산을"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "구현해야한다는"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "필요가"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "있기"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "때문에"
                            },
                            {
                                "type": "text",
                                "text": ", D "
                            },
                            {
                                "type": "text",
                                "text": "상태의"
                            },
                            {
                                "type": "text",
                                "text": " weight "
                            },
                            {
                                "type": "text",
                                "text": "를"
                            },
                            {
                                "type": "text",
                                "text": " forward "
                            },
                            {
                                "type": "text",
                                "text": "연산에서"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "사용하게"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "됩니다"
                            },
                            {
                                "type": "text",
                                "text": ". (1) B "
                            },
                            {
                                "type": "text",
                                "text": "상태로"
                            },
                            {
                                "type": "text",
                                "text": " MATMUL -> Output "
                            },
                            {
                                "type": "text",
                                "text": "에"
                            },
                            {
                                "type": "text",
                                "text": " C "
                            },
                            {
                                "type": "text",
                                "text": "곱하기"
                            },
                            {
                                "type": "text",
                                "text": ",  2) weight "
                            },
                            {
                                "type": "text",
                                "text": "를"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "처음부터"
                            },
                            {
                                "type": "text",
                                "text": " D "
                            },
                            {
                                "type": "text",
                                "text": "상태로"
                            },
                            {
                                "type": "text",
                                "text": " MATMUL "
                            },
                            {
                                "type": "text",
                                "text": "을"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "하는"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "것"
                            },
                            {
                                "type": "text",
                                "text": ", 1, 2"
                            },
                            {
                                "type": "text",
                                "text": "는"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "연산적으로"
                            },
                            {
                                "type": "text",
                                "text": " Equivalent "
                            },
                            {
                                "type": "text",
                                "text": "함"
                            },
                            {
                                "type": "text",
                                "text": ")\n\n"
                            },
                            {
                                "type": "text",
                                "text": "추가로"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "궁금한"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "점이"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "있으시거나"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "제가"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "잘못말한부분이"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "있다면"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "말씀해주시면"
                            },
                            {
                                "type": "text",
                                "text": " "
                            },
                            {
                                "type": "text",
                                "text": "감사드리겠습니다"
                            },
                            {
                                "type": "text",
                                "text": " :)"
                            }
                        ]
                    }
                ]
            }
        ],
        "team": "T04MCQMEXQ9",
        "user_team": "T04MCQMEXQ9",
        "source_team": "T04MCQMEXQ9",
        "user_profile": {
            "avatar_hash": "7026e9e9c4f8",
            "image_72": "https:\/\/avatars.slack-edge.com\/2023-01-29\/4699821662839_7026e9e9c4f8501ee814_72.png",
            "first_name": "김민수\/한양대",
            "real_name": "김민수\/한양대",
            "display_name": "김민수\/한양대",
            "team": "T04MCQMEXQ9",
            "name": "minsoo2333",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1682038867.781049",
        "parent_user_id": "U053Y5G924T",
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U04M05UHX7U",
                    "U053Y5G924T",
                    "U04MQHDJ12L"
                ],
                "count": 3
            }
        ]
    },
    {
        "client_msg_id": "a6d29bf0-8709-4f6a-83fc-660626c6470c",
        "type": "message",
        "text": "보신 코드가 어떤지 모르겠으나 backprop하고 섞여있는 코드라서 그런것 같습니다.\n질문주신대로 conv2dLSQ가 동작한다면 inference때 quantization으로 latency나 throughput을 향상하고자 하는 의미가 없게 됩니다.\n\nCNN계열은 일반적으로 inference때 batch 처리가 주가 되기에 weight reuse의 비율이 커서 computation에 bound가 걸리게 됩니다.\n\n\"QuantizationandTrainingofNeuralNetworksforEfficient Integer-Arithmetic-Only Inference\" 논문을 참고해서 구현하는 것이 아닌이상 weight(int) -&gt; weight(fp32)로 하게되면 연산에서 이득은 없고 GPU DRAM -&gt; SRAM으로 갈때의 이득밖에 없게 되는데 computation bound에서는 이득이 미비하거나 없습니다.\n\npool이나 inference에 필요한 모든 연산이 int8로 연산되어 가속이 되는것이 아니라면 computation에서 가장 큰 비중을 차지하는 conv 위주로 가속이 발생할 것이고 이 경우 latency나 throughput측면에서 큰 향상을 보기 어려운 경우가 많습니다. fp16 TFLOPS대비 int8이 2배의 TOPS를 보인다 해도 1.5배 정도 향상이면 잘되는 경우가 많은데 보통 아래가 원인이 되기도 합니다.(딱 이렇다라고 할수는 없지만 경험상 아래의 경우로 이득보는데 한계가 있었습니다.)\n\n1. inference가 conv로만 이루어져 있지 않다보니 다른 operation 비중(maxpool, activation function 등...)까지 생각한다면 conv 비중이 얼마인가에 따라 latency 향상이 달라짐\n2. int로만 된것이 아니고 중간에 fp연산이 섞이면 data reordering에 시간이 많이 들어감",
        "user": "U04LXKFJLFP",
        "ts": "1682043757.489739",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "qUX",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "보신 코드가 어떤지 모르겠으나 backprop하고 섞여있는 코드라서 그런것 같습니다.\n질문주신대로 conv2dLSQ가 동작한다면 inference때 quantization으로 latency나 throughput을 향상하고자 하는 의미가 없게 됩니다.\n\nCNN계열은 일반적으로 inference때 batch 처리가 주가 되기에 weight reuse의 비율이 커서 computation에 bound가 걸리게 됩니다.\n\n\"QuantizationandTrainingofNeuralNetworksforEfficient Integer-Arithmetic-Only Inference\" 논문을 참고해서 구현하는 것이 아닌이상 weight(int) -> weight(fp32)로 하게되면 연산에서 이득은 없고 GPU DRAM -> SRAM으로 갈때의 이득밖에 없게 되는데 computation bound에서는 이득이 미비하거나 없습니다.\n\npool이나 inference에 필요한 모든 연산이 int8로 연산되어 가속이 되는것이 아니라면 computation에서 가장 큰 비중을 차지하는 conv 위주로 가속이 발생할 것이고 이 경우 latency나 throughput측면에서 큰 향상을 보기 어려운 경우가 많습니다. fp16 TFLOPS대비 int8이 2배의 TOPS를 보인다 해도 1.5배 정도 향상이면 잘되는 경우가 많은데 보통 아래가 원인이 되기도 합니다.(딱 이렇다라고 할수는 없지만 경험상 아래의 경우로 이득보는데 한계가 있었습니다.)\n\n1. inference가 conv로만 이루어져 있지 않다보니 다른 operation 비중(maxpool, activation function 등...)까지 생각한다면 conv 비중이 얼마인가에 따라 latency 향상이 달라짐\n2. int로만 된것이 아니고 중간에 fp연산이 섞이면 data reordering에 시간이 많이 들어감"
                            }
                        ]
                    }
                ]
            }
        ],
        "team": "T04MCQMEXQ9",
        "user_team": "T04MCQMEXQ9",
        "source_team": "T04MCQMEXQ9",
        "user_profile": {
            "avatar_hash": "920781349530",
            "image_72": "https:\/\/avatars.slack-edge.com\/2023-01-29\/4717072295892_9207813495302462dd55_72.jpg",
            "first_name": "ByeongWook",
            "real_name": "ByeongWook Kim",
            "display_name": "김병욱\/네이버클라우드",
            "team": "T04MCQMEXQ9",
            "name": "quddnr145",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "edited": {
            "user": "U04LXKFJLFP",
            "ts": "1682044590.000000"
        },
        "thread_ts": "1682038867.781049",
        "parent_user_id": "U053Y5G924T",
        "reactions": [
            {
                "name": "+1",
                "users": [
                    "U04M05UHX7U",
                    "U053Y5G924T",
                    "U04M2NY6U2Y",
                    "U04MQHDJ12L",
                    "U04LY25D7C5"
                ],
                "count": 5
            }
        ]
    },
    {
        "client_msg_id": "9e2a6770-aae1-4dc1-a791-32037b32b215",
        "type": "message",
        "text": "두 분 모두 답변 정말 감사드립니다. 병욱님이 말씀하신 대로 computation의 이득은 미비하다고 생각되고, 민수님의 답변을  보니 step-size를 곱해서 연산한 이유를 알 것 같습니다.\n감사합니다!!",
        "user": "U053Y5G924T",
        "ts": "1682049026.986879",
        "blocks": [
            {
                "type": "rich_text",
                "block_id": "Fuork",
                "elements": [
                    {
                        "type": "rich_text_section",
                        "elements": [
                            {
                                "type": "text",
                                "text": "두 분 모두 답변 정말 감사드립니다. 병욱님이 말씀하신 대로 computation의 이득은 미비하다고 생각되고, 민수님의 답변을  보니 step-size를 곱해서 연산한 이유를 알 것 같습니다.\n감사합니다!!"
                            }
                        ]
                    }
                ]
            }
        ],
        "team": "T04MCQMEXQ9",
        "user_team": "T04MCQMEXQ9",
        "source_team": "T04MCQMEXQ9",
        "user_profile": {
            "avatar_hash": "5fc60de0af34",
            "image_72": "https:\/\/avatars.slack-edge.com\/2023-04-19\/5131369697333_5fc60de0af343a4374f8_72.png",
            "first_name": "정원기",
            "real_name": "정원기 \/ 서울대학교",
            "display_name": "정원기 \/ 서울대학교",
            "team": "T04MCQMEXQ9",
            "name": "wg7139",
            "is_restricted": false,
            "is_ultra_restricted": false
        },
        "thread_ts": "1682038867.781049",
        "parent_user_id": "U053Y5G924T",
        "reactions": [
            {
                "name": "man-bowing",
                "users": [
                    "U04M2NY6U2Y"
                ],
                "count": 1
            },
            {
                "name": "bow",
                "users": [
                    "U04LXKFJLFP"
                ],
                "count": 1
            }
        ]
    }
]